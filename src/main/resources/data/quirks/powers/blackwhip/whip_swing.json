{
    "type":"origins:multiple",
    "callback":{
       "type":"origins:action_on_callback",
       "entity_action_gained":{
          "type":"origins:and",
          "actions":[
             {
                "type":"origins:execute_command",
                "command":"tag @s add quirks.whip_swing_user"
             },
             {
                "type":"origins:execute_command",
                "command":"scoreboard objectives add BlackwhipUUID dummy"
             },
             {
                "type":"origins:delay",
                "action":{
                   "type":"origins:execute_command",
                   "command":"execute store result score @s BlackwhipUUID run data get entity @s UUID[0]"
                },
                "ticks":1
             }
          ]
       },
       "entity_action_lost":{
         "type": "origins:and",
         "actions": [
            {
               "type":"origins:execute_command",
               "command":"tag @s remove quirks.whip_swing_user"
            },
            {
               "type":"origins:execute_command",
               "command":"power revokeall @s quirks:blackwhip"
            }
         ]
       }
    },
    "spawn":{
       "type":"origins:active_self",
       "entity_action":{
          "type":"origins:if_else",
          "condition":{
             "type":"origins:command",
             "command":"execute as @e[type=bat,nbt={Tags:['blackwhip_hook']},distance=..27.5] if score @s BlackwhipUUID = @p[distance=0] BlackwhipUUID",
             "comparison":">",
             "compare_to":0
          },
          "if_action":{
             "type":"origins:execute_command",
             "command":"execute as @e[type=bat,nbt={Tags:['blackwhip_hook']},distance=..27.5] if score @s BlackwhipUUID = @p[distance=0] BlackwhipUUID run function quirks:blackwhip/whip_swing_hook_kill"
          },
          "else_action":{
             "type":"origins:raycast",
             "distance":25.00,
             "block":true,
             "entity":false,
             "shape_type":"collider",
             "fluid_handling":"none",
             "hit_action":{
                "type":"origins:and",
                "actions":[
                   {
                      "type":"origins:swing_hand",
                      "hand":"MAIN_HAND"
                   },
                   {
                      "type":"origins:play_sound",
                      "sound":"minecraft:item.crossbow.shoot",
                      "category":"players",
                      "volume":0.20,
                      "pitch":1.60
                   },
                   {
                      "type":"origins:play_sound",
                      "sound":"minecraft:entity.phantom.bite",
                      "category":"players",
                      "volume":1.00,
                      "pitch":2.00
                   }
                ]
             },
             "command_at_hit":"function quirks:blackwhip/whip_swing_hook_spawn",
             "command_hit_offset":0.5
          }
       },
       "cooldown":1,
       "hud_render":{
          "should_render":false
       },
       "key":{
          "key":"key.quirks.primary",
          "continuous":false
       },
       "condition": {
         "type": "origins:resource",
         "resource": "quirks:universal/quirk_erased",
         "comparison": "==",
         "compare_to": 0
       }
    },
    "slow_falling":{
       "type":"origins:modify_falling",
       "take_fall_damage":false,
       "velocity":0.04,
       "condition":{
          "type":"origins:command",
          "command":"execute as @e[type=bat,nbt={Tags:['blackwhip_hook']},distance=..27.5] if score @s BlackwhipUUID = @p[distance=0] BlackwhipUUID",
          "comparison":">",
          "compare_to":0
       }
    },
    "pull":{
       "type":"origins:action_over_time",
       "entity_action":{
          "type":"origins:and",
          "actions":[
             {
                "type":"origins:execute_command",
                "command":"execute as @e[type=bat,nbt={Tags:['blackwhip_hook']},distance=..27.5] if score @s BlackwhipUUID = @p[distance=0] BlackwhipUUID run damage @s 0 generic_kill by @p[distance=0]"
             },
             {
                "type":"origins:selector_action",
                "selector":"@e[type = minecraft:bat,distance=7.5..27.5,nbt={Tags:['blackwhip_hook']}]",
                "bientity_action":{
                   "type":"origins:invert",
                   "action":{
                      "type":"origins:if_else",
                      "condition":{
                         "type":"origins:target_condition",
                         "condition":{
                            "type":"origins:sneaking"
                         }
                      },
                      "if_action":{
                         "type":"origins:add_velocity",
                         "x":0.00,
                         "y":0.00,
                         "z":-0.035,
                         "reference":"position",
                         "set":false
                      },
                      "else_action":{
                         "type":"origins:add_velocity",
                         "x":0.00,
                         "y":0.00,
                         "z":-0.10,
                         "reference":"position",
                         "set":false
                      }
                   }
                },
                "bientity_condition":{
                   "type":"origins:attacker"
                }
             }
          ]
       },
       "falling_action": {
         "type":"origins:execute_command",
         "command":"execute as @e[type=bat,nbt={Tags:['blackwhip_hook']},distance=..27.5] if score @s BlackwhipUUID = @p[distance=0] BlackwhipUUID run function quirks:blackwhip/whip_swing_hook_kill"
       },
       "interval":1,
       "condition":{
         "type": "origins:and",
         "conditions": [
            {
               "type":"origins:command",
               "command":"execute as @e[type=bat,nbt={Tags:['blackwhip_hook']},distance=..27.5] if score @s BlackwhipUUID = @p[distance=0] BlackwhipUUID",
               "comparison":">",
               "compare_to":0
            },
            {
               "type": "origins:resource",
               "resource": "quirks:universal/quirk_erased",
               "comparison": "==",
               "compare_to": 0
            }
         ]
       }
    },
    "forward":{
       "type":"origins:active_self",
       "entity_action":{
          "type":"origins:add_velocity",
          "x":0.00,
          "y":0.00,
          "z":0.05,
          "space":"local",
          "set":false
       },
       "cooldown":1,
       "hud_render":{
          "should_render":false
       },
       "key":{
          "key":"key.forward",
          "continuous":true
       },
       "condition":{
          "type":"origins:command",
          "command":"execute as @e[type=bat,nbt={Tags:['blackwhip_hook']},distance=..27.5] if score @s BlackwhipUUID = @p[distance=0] BlackwhipUUID",
          "comparison":">",
          "compare_to":0
       }
    },
    "back":{
       "type":"origins:active_self",
       "entity_action":{
          "type":"origins:add_velocity",
          "x":0.00,
          "y":0.00,
          "z":-0.05,
          "space":"local",
          "set":false
       },
       "cooldown":1,
       "hud_render":{
          "should_render":false
       },
       "key":{
          "key":"key.back",
          "continuous":true
       },
       "condition":{
          "type":"origins:command",
          "command":"execute as @e[type=bat,nbt={Tags:['blackwhip_hook']},distance=..27.5] if score @s BlackwhipUUID = @p[distance=0] BlackwhipUUID",
          "comparison":">",
          "compare_to":0
       }
    },
    "left":{
       "type":"origins:active_self",
       "entity_action":{
          "type":"origins:add_velocity",
          "x":0.05,
          "y":0.00,
          "z":0.00,
          "space":"local",
          "set":false
       },
       "cooldown":1,
       "hud_render":{
          "should_render":false
       },
       "key":{
          "key":"key.left",
          "continuous":true
       },
       "condition":{
          "type":"origins:command",
          "command":"execute as @e[type=bat,nbt={Tags:['blackwhip_hook']},distance=..27.5] if score @s BlackwhipUUID = @p[distance=0] BlackwhipUUID",
          "comparison":">",
          "compare_to":0
       }
    },
    "right":{
       "type":"origins:active_self",
       "entity_action":{
          "type":"origins:add_velocity",
          "x":-0.05,
          "y":0.00,
          "z":0.00,
          "space":"local",
          "set":false
       },
       "cooldown":1,
       "hud_render":{
          "should_render":false
       },
       "key":{
          "key":"key.right",
          "continuous":true
       },
       "condition":{
          "type":"origins:command",
          "command":"execute as @e[type=bat,nbt={Tags:['blackwhip_hook']},distance=..27.5] if score @s BlackwhipUUID = @p[distance=0] BlackwhipUUID",
          "comparison":">",
          "compare_to":0
       }
    },
    "up":{
       "type":"origins:active_self",
       "entity_action":{
          "type":"origins:selector_action",
          "selector":"@e[type = minecraft:bat,distance = 1..7.5,sort=nearest,limit=1,nbt={Tags:['blackwhip_hook']}]",
          "bientity_action":{
             "type":"origins:invert",
             "action":{
                "type":"origins:add_velocity",
                "x":0.00,
                "y":0.00,
                "z":-0.10,
                "reference":"position",
                "set":false
             }
          },
          "bientity_condition":{
             "type":"origins:attacker"
          }
       },
       "cooldown":1,
       "hud_render":{
          "should_render":false
       },
       "key":{
          "key":"key.jump",
          "continuous":true
       },
       "condition":{
          "type":"origins:command",
          "command":"execute as @e[type=bat,nbt={Tags:['blackwhip_hook']},distance=..7.5] if score @s BlackwhipUUID = @p[distance=0] BlackwhipUUID",
          "comparison":">",
          "compare_to":0
       }
    }
}